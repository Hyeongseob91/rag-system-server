# RAG Pipeline v2.0

**OpenAI API + Qdrant Hybrid Search ê¸°ë°˜ ê³ ì„±ëŠ¥ RAG(Retrieval-Augmented Generation) ì‹œìŠ¤í…œ**

í¬íŠ¸í´ë¦¬ì˜¤ìš© ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ RAG QA ì‹œìŠ¤í…œìœ¼ë¡œ, LangGraph ê¸°ë°˜ì˜ ì§€ëŠ¥í˜• ì›Œí¬í”Œë¡œìš°ì™€ Hybrid Search(Dense + BM25 Sparse)ë¥¼ í†µí•œ ì •ë°€í•œ ë¬¸ì„œ ê²€ìƒ‰ì„ ì œê³µí•©ë‹ˆë‹¤.

---

## ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
2. [í•µì‹¬ ê¸°ëŠ¥](#2-í•µì‹¬-ê¸°ëŠ¥)
3. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#3-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
4. [ê¸°ìˆ  ìŠ¤íƒ](#4-ê¸°ìˆ -ìŠ¤íƒ)
5. [ë””ë ‰í† ë¦¬ êµ¬ì¡°](#5-ë””ë ‰í† ë¦¬-êµ¬ì¡°)
6. [ì›Œí¬í”Œë¡œìš° ìƒì„¸](#6-ì›Œí¬í”Œë¡œìš°-ìƒì„¸)
7. [ì»´í¬ë„ŒíŠ¸ë³„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§](#7-ì»´í¬ë„ŒíŠ¸ë³„-ë¹„ì¦ˆë‹ˆìŠ¤-ë¡œì§)
8. [Docker Compose êµ¬ì„±](#8-docker-compose-êµ¬ì„±)
9. [ì‹¤í–‰ ë°©ë²•](#9-ì‹¤í–‰-ë°©ë²•)
10. [API Reference](#10-api-reference)
11. [í™˜ê²½ ë³€ìˆ˜](#11-í™˜ê²½-ë³€ìˆ˜)
12. [ê°œë°œ ê°€ì´ë“œ](#12-ê°œë°œ-ê°€ì´ë“œ)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 í”„ë¡œì íŠ¸ ì†Œê°œ

RAG Pipelineì€ **ê¸°ì—… ë‚´ë¶€ ë¬¸ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì •í™•í•œ ë‹µë³€ì„ ìƒì„±**í•˜ëŠ” AI QA ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ì‚¬ìš©ìê°€ PDF, DOCX, XLSX ë“±ì˜ ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•˜ë©´, ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ ë¬¸ì„œë¥¼ íŒŒì‹±í•˜ê³  ì˜ë¯¸ ë‹¨ìœ„ë¡œ ë¶„í• (Semantic Chunking)í•˜ì—¬ ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤. ì´í›„ ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ëŒ€í•´ ê´€ë ¨ ë¬¸ì„œë¥¼ ê²€ìƒ‰í•˜ê³ , ê²€ìƒ‰ëœ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ LLMì´ ì •í™•í•œ ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤.

### 1.2 í•´ê²°í•˜ëŠ” ë¬¸ì œ

| ë¬¸ì œ | í•´ê²°ì±… |
|------|--------|
| ë‹¨ìˆœ í‚¤ì›Œë“œ ê²€ìƒ‰ì˜ í•œê³„ | **Hybrid Search**: Dense Vector + BM25 Sparse Vectorë¥¼ RRFë¡œ ìœµí•© |
| ëŒ€ê·œëª¨ ë¬¸ì„œì—ì„œ ê´€ë ¨ ë‚´ìš© ì°¾ê¸° ì–´ë ¤ì›€ | **Semantic Chunking**: ì˜ë¯¸ ë‹¨ìœ„ë¡œ ë¬¸ì„œ ë¶„í•  í›„ ê²€ìƒ‰ |
| LLM í™˜ê°(Hallucination) ë¬¸ì œ | **Grounded Generation**: ê²€ìƒ‰ëœ ë¬¸ì„œë§Œ ì°¸ì¡°í•˜ì—¬ ë‹µë³€ ìƒì„± |
| ê²€ìƒ‰ ê²°ê³¼ í’ˆì§ˆ ì €í•˜ | **Cross-Encoder Reranking**: ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì¬ì •ë ¬í•˜ì—¬ ìƒìœ„ ë¬¸ì„œë§Œ ì‚¬ìš© |
| ë¶ˆí•„ìš”í•œ ê²€ìƒ‰ ë¹„ìš© | **Intelligent Routing**: ê²€ìƒ‰ì´ í•„ìš”í•œ ì§ˆë¬¸ë§Œ RAG íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ |

### 1.3 í•µì‹¬ ì„¤ê³„ ì›ì¹™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ì„¤ê³„ ì›ì¹™                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. ì •í™•ì„± ìš°ì„  (Accuracy First)                                â”‚
â”‚     - ë¬¸ì„œì— ì—†ëŠ” ë‚´ìš©ì€ ìƒì„±í•˜ì§€ ì•ŠìŒ                           â”‚
â”‚     - ì¶œì²˜ í‘œê¸°ë¡œ ë‹µë³€ì˜ ì‹ ë¢°ì„± í™•ë³´                             â”‚
â”‚                                                                 â”‚
â”‚  2. í™•ì¥ì„± (Scalability)                                        â”‚
â”‚     - ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ (Docker Compose)                   â”‚
â”‚     - ê° ì»´í¬ë„ŒíŠ¸ ë…ë¦½ì  ìŠ¤ì¼€ì¼ë§ ê°€ëŠ¥                           â”‚
â”‚                                                                 â”‚
â”‚  3. íš¨ìœ¨ì„± (Efficiency)                                         â”‚
â”‚     - GPUëŠ” Rerankerì—ë§Œ ì‚¬ìš© (ë¹„ìš© ìµœì í™”)                      â”‚
â”‚     - ë¶ˆí•„ìš”í•œ ê²€ìƒ‰ íšŒí”¼ (Router)                                â”‚
â”‚                                                                 â”‚
â”‚  4. ìœ ì§€ë³´ìˆ˜ì„± (Maintainability)                                â”‚
â”‚     - ê³„ì¸µí™”ëœ ì•„í‚¤í…ì²˜ (Presentation â†’ Service â†’ Data)          â”‚
â”‚     - ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. í•µì‹¬ ê¸°ëŠ¥

### 2.1 ë¬¸ì„œ ì²˜ë¦¬

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **ë‹¤ì¤‘ íŒŒì¼ í˜•ì‹ ì§€ì›** | PDF, DOCX, XLSX, TXT, JSON, Markdown |
| **PDF í…Œì´ë¸” ì¶”ì¶œ** | pdfplumberë¡œ í…Œì´ë¸” êµ¬ì¡° ë³´ì¡´ |
| **í˜ì´ì§€ ì œí•œ** | ëŒ€ìš©ëŸ‰ PDFëŠ” ìµœì´ˆ 3í˜ì´ì§€ë§Œ ì²˜ë¦¬ (ì„¤ì • ê°€ëŠ¥) |
| **ì¸ì½”ë”© ìë™ ê°ì§€** | UTF-8, CP949, EUC-KR, Latin-1 ìˆœì°¨ ì‹œë„ |

### 2.2 ê²€ìƒ‰ ì‹œìŠ¤í…œ

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **Hybrid Search** | Dense Vector (OpenAI) + Sparse Vector (BM25) ê²°í•© |
| **RRF Fusion** | Reciprocal Rank Fusionìœ¼ë¡œ ë‘ ê²€ìƒ‰ ê²°ê³¼ ìœµí•© |
| **Cross-Encoder Reranking** | BAAI/bge-reranker-v2-m3ë¡œ ê²€ìƒ‰ ê²°ê³¼ ì¬ì •ë ¬ |

### 2.3 ë‹µë³€ ìƒì„±

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **Query Rewriting** | ê²€ìƒ‰ ìµœì í™”ë¥¼ ìœ„í•œ ì¿¼ë¦¬ ì¬ì‘ì„± (5ê°œ ë³€í˜• ìƒì„±) |
| **Grounded Generation** | ê²€ìƒ‰ëœ ë¬¸ì„œ ê¸°ë°˜ ë‹µë³€ ìƒì„± |
| **ì¶œì²˜ í‘œê¸°** | ë‹µë³€ ë¬¸ì¥ë³„ ì¶œì²˜ ë²ˆí˜¸ í‘œê¸° (ì˜ˆ: [1], [2]) |
| **Intelligent Routing** | ê²€ìƒ‰ í•„ìš” ì—¬ë¶€ ìë™ íŒë‹¨ |

### 2.4 ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **React Dashboard** | íŒŒì¼ ì—…ë¡œë“œ, í† í° ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§ |
| **ì‹¤ì‹œê°„ ì±„íŒ…** | Markdown ë Œë”ë§, ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ |
| **Drag & Drop ì—…ë¡œë“œ** | ì§ê´€ì ì¸ íŒŒì¼ ì—…ë¡œë“œ UX |

---

## 3. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 3.1 ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Docker Compose                                    â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚             â”‚    â”‚              Backend (FastAPI)                   â”‚    â”‚
â”‚  â”‚   Frontend  â”‚â”€â”€â”€â–¶â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚   (React)   â”‚    â”‚  â”‚   API   â”‚â”€â”€â”‚ Service â”‚â”€â”€â”‚   LangGraph     â”‚  â”‚    â”‚
â”‚  â”‚   :5173     â”‚â—€â”€â”€â”€â”‚  â”‚ Routes  â”‚  â”‚  Layer  â”‚  â”‚   Workflow      â”‚  â”‚    â”‚
â”‚  â”‚             â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚             â”‚               â”‚           â”‚    â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚             â”‚               â”‚                 â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚         â”‚                                                           â”‚       â”‚
â”‚         â–¼                   â–¼                   â–¼                   â–¼       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Qdrant    â”‚    â”‚  Infinity   â”‚    â”‚    Redis    â”‚    â”‚   OpenAI    â”‚  â”‚
â”‚  â”‚  (Vector)   â”‚    â”‚ (Reranker)  â”‚    â”‚   (Cache)   â”‚    â”‚    API      â”‚  â”‚
â”‚  â”‚   :6333     â”‚    â”‚    :8002    â”‚    â”‚    :6379    â”‚    â”‚  (External) â”‚  â”‚
â”‚  â”‚             â”‚    â”‚  [GPU]      â”‚    â”‚             â”‚    â”‚             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                   â”‚                                               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚                  â”‚                                                          â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚          â”‚  RTX 4060 8GB â”‚                                                  â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ë°ì´í„° íë¦„

```
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚           Document Upload Flow           â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ User â”‚â”€â”€â”€â”€â”€â–¶â”‚ Frontend â”‚â”€â”€â”€â”€â”€â–¶â”‚  FastAPI  â”‚â”€â”€â”€â”€â”€â–¶â”‚ Pipeline â”‚â”€â”€â”€â”€â”€â–¶â”‚ Qdrant â”‚
    â”‚      â”‚ file â”‚          â”‚ POST â”‚           â”‚      â”‚          â”‚      â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚    Preprocessing Pipeline    â”‚
                            â”‚                             â”‚
                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                            â”‚  â”‚ Parser  â”‚â”€â”€â–¶â”‚Normalizerâ”‚ â”‚
                            â”‚  â”‚(PDF/Doc)â”‚   â”‚(ì •ê·œí™”) â”‚  â”‚
                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚
                            â”‚                     â”‚       â”‚
                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚       â”‚
                            â”‚  â”‚ SemanticChunker â”‚â”‚       â”‚
                            â”‚  â”‚(ì˜ë¯¸ ë‹¨ìœ„ ë¶„í• ) â”‚â—€â”˜       â”‚
                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                            â”‚           â”‚                 â”‚
                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
                            â”‚  â”‚ Dense + Sparse  â”‚        â”‚
                            â”‚  â”‚   Embedding     â”‚        â”‚
                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚             RAG Query Flow               â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ User â”‚â”€â”€â”€â”€â”€â–¶â”‚ Frontend â”‚â”€â”€â”€â”€â”€â–¶â”‚  FastAPI  â”‚â”€â”€â”€â”€â”€â–¶â”‚   LangGraph Workflow  â”‚
    â”‚      â”‚  Q   â”‚          â”‚ POST â”‚    API    â”‚      â”‚                       â”‚
    â””â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                 â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     LangGraph Workflow                       â”‚
         â”‚                                                             â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
         â”‚   â”‚ Router  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
         â”‚   â”‚ (ë¶„ê¸°)  â”‚                      â”‚                        â”‚
         â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                      â”‚                        â”‚
         â”‚        â”‚                           â”‚                        â”‚
         â”‚   vectorstore                    llm                        â”‚
         â”‚        â”‚                           â”‚                        â”‚
         â”‚        â–¼                           â–¼                        â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
         â”‚   â”‚ Query   â”‚               â”‚  Simple   â”‚                   â”‚
         â”‚   â”‚ Rewrite â”‚               â”‚ Generator â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
         â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜               â”‚ (ì¼ë°˜ëŒ€í™”)â”‚              â”‚    â”‚
         â”‚        â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚    â”‚
         â”‚        â–¼                                               â”‚    â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚    â”‚
         â”‚   â”‚Retrieverâ”‚â—€â”€â”€ Qdrant Hybrid Search                  â”‚    â”‚
         â”‚   â”‚         â”‚â—€â”€â”€ Infinity Reranker                     â”‚    â”‚
         â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                          â”‚    â”‚
         â”‚        â”‚                                               â”‚    â”‚
         â”‚        â–¼                                               â”‚    â”‚
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚    â”‚
         â”‚   â”‚Generatorâ”‚                                          â”‚    â”‚
         â”‚   â”‚ (RAG)   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚                â”‚
         â”‚                                            â–¼                â”‚
         â”‚                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
         â”‚                                       â”‚   END   â”‚           â”‚
         â”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Hybrid Search ìƒì„¸

```
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚           Hybrid Search Flow            â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                      Query: "í™˜ë¶ˆ ê·œì •"
                                              â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚                                              â”‚
                       â–¼                                              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Dense Vector   â”‚                          â”‚  Sparse Vector  â”‚
              â”‚   Embedding     â”‚                          â”‚     (BM25)      â”‚
              â”‚    (OpenAI)     â”‚                          â”‚   (FastEmbed)   â”‚
              â”‚                 â”‚                          â”‚                 â”‚
              â”‚ [0.12, -0.34,   â”‚                          â”‚ indices: [12,   â”‚
              â”‚  0.56, ...]     â”‚                          â”‚   345, 789]     â”‚
              â”‚ (1536 dims)     â”‚                          â”‚ values: [0.8,   â”‚
              â”‚                 â”‚                          â”‚   0.5, 0.3]     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                                            â”‚
                       â–¼                                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Qdrant Dense   â”‚                          â”‚ Qdrant Sparse   â”‚
              â”‚     Search      â”‚                          â”‚    Search       â”‚
              â”‚                 â”‚                          â”‚                 â”‚
              â”‚  Top 30 docs    â”‚                          â”‚  Top 30 docs    â”‚
              â”‚  (cosine sim)   â”‚                          â”‚  (BM25 score)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                                            â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   RRF (Reciprocal     â”‚
                              â”‚   Rank Fusion)        â”‚
                              â”‚                       â”‚
                              â”‚   score = Î£ 1/(k+r)   â”‚
                              â”‚   k=60, r=rank        â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  Cross-Encoder        â”‚
                              â”‚  Reranking            â”‚
                              â”‚  (Infinity Server)    â”‚
                              â”‚                       â”‚
                              â”‚  BAAI/bge-reranker-   â”‚
                              â”‚  v2-m3                â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   Top 5 Documents     â”‚
                              â”‚   (Final Result)      â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ê¸°ìˆ  ìŠ¤íƒ

### 4.1 Frontend

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| React | 19.2 | UI í”„ë ˆì„ì›Œí¬ |
| TypeScript | 5.9 | íƒ€ì… ì•ˆì •ì„± |
| Vite | 5.4 | ë¹Œë“œ ë„êµ¬ |
| Tailwind CSS | 3.4 | ìŠ¤íƒ€ì¼ë§ |
| Axios | 1.13 | HTTP í´ë¼ì´ì–¸íŠ¸ |
| Recharts | 3.5 | ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| Lucide React | 0.555 | ì•„ì´ì½˜ |
| React Markdown | 10.1 | Markdown ë Œë”ë§ |

### 4.2 Backend

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| Python | 3.13 | ëŸ°íƒ€ì„ |
| FastAPI | 0.115 | REST API |
| LangChain | 0.2+ | LLM í”„ë ˆì„ì›Œí¬ |
| LangGraph | 0.2+ | ì›Œí¬í”Œë¡œìš° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ |
| Pydantic | 2.x | ë°ì´í„° ê²€ì¦ |
| uvicorn | 0.32 | ASGI ì„œë²„ |

### 4.3 AI/ML

| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **OpenAI GPT-4o-mini** | Query Rewriting, Routing |
| **OpenAI GPT-4o** | ë‹µë³€ ìƒì„± (Generator) |
| **OpenAI text-embedding-3-small** | Dense Vector Embedding (1536 dims) |
| **FastEmbed Qdrant/bm25** | Sparse Vector (BM25) |
| **BAAI/bge-reranker-v2-m3** | Cross-Encoder Reranking |
| **LangChain SemanticChunker** | ì˜ë¯¸ ê¸°ë°˜ ë¬¸ì„œ ë¶„í•  |

### 4.4 Infrastructure

| ê¸°ìˆ  | ë²„ì „ | ìš©ë„ |
|------|------|------|
| **Qdrant** | latest | Vector Database (Hybrid Search) |
| **Infinity** | latest | Reranker Model Serving (GPU) |
| **Redis** | 7-alpine | ìºì‹± (Future Use) |
| **Docker Compose** | 3.8 | ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ |
| **Nginx** | alpine | Frontend Reverse Proxy |

### 4.5 ë¬¸ì„œ ì²˜ë¦¬

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ìš©ë„ |
|------------|------|
| pdfplumber | PDF íŒŒì‹± (í…ìŠ¤íŠ¸ + í…Œì´ë¸”) |
| python-docx | DOCX íŒŒì‹± |
| openpyxl | XLSX íŒŒì‹± |

---

## 5. ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
RAG-Pipeline/
â”‚
â”œâ”€â”€ ğŸ“ src/                          # ë°±ì—”ë“œ ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ ğŸ“ api/                      # FastAPI REST API
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py                  # FastAPI ì•± ì§„ì…ì 
â”‚   â”‚   â”œâ”€â”€ dependencies.py          # ì˜ì¡´ì„± ì£¼ì… (DI Container)
â”‚   â”‚   â”œâ”€â”€ schemas.py               # API Request/Response ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â””â”€â”€ ğŸ“ routes/               # API ë¼ìš°í„°
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ query.py             # POST /api/v1/query
â”‚   â”‚       â”œâ”€â”€ upload.py            # POST /api/v1/upload
â”‚   â”‚       â””â”€â”€ admin.py             # GET /api/v1/health, collections
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ config/                   # ì„¤ì • ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ settings.py              # ì „ì²´ ì„¤ì • (dataclass)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ graph/                    # LangGraph ì›Œí¬í”Œë¡œìš°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ workflow.py              # RAGWorkflow í´ë˜ìŠ¤
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ nodes/                    # LangGraph ë…¸ë“œë“¤
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py                  # BaseNode ì¶”ìƒ í´ë˜ìŠ¤
â”‚   â”‚   â”œâ”€â”€ query_rewrite.py         # QueryRewriteNode
â”‚   â”‚   â”œâ”€â”€ retriever.py             # RetrieverNode
â”‚   â”‚   â”œâ”€â”€ generator.py             # GeneratorNode (RAG)
â”‚   â”‚   â””â”€â”€ simple_generator.py      # SimpleGeneratorNode (ì¼ë°˜ëŒ€í™”)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ prompts/                  # í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ templates.py             # System/Human í”„ë¡¬í”„íŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ schemas/                  # ë°ì´í„° ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ state.py                 # LangGraph State (TypedDict)
â”‚   â”‚   â”œâ”€â”€ models.py                # Pydantic ëª¨ë¸ (Structured Output)
â”‚   â”‚   â””â”€â”€ preprocessing.py         # ì „ì²˜ë¦¬ ê´€ë ¨ ìŠ¤í‚¤ë§ˆ
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ services/                 # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë ˆì´ì–´
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ llm.py                   # LLMService (OpenAI)
â”‚       â”œâ”€â”€ vectorstore.py           # VectorStoreService (Qdrant)
â”‚       â”œâ”€â”€ reranker.py              # RerankerService (Infinity)
â”‚       â”œâ”€â”€ bm25.py                  # BM25Service (FastEmbed)
â”‚       â””â”€â”€ ğŸ“ preprocessing/        # ë¬¸ì„œ ì „ì²˜ë¦¬
â”‚           â”œâ”€â”€ __init__.py
â”‚           â”œâ”€â”€ parsers.py           # íŒŒì¼ íŒŒì„œ (PDF, DOCX, XLSX...)
â”‚           â”œâ”€â”€ normalizer.py        # í…ìŠ¤íŠ¸ ì •ê·œí™”
â”‚           â”œâ”€â”€ chunking.py          # SemanticChunker
â”‚           â””â”€â”€ pipeline.py          # PreprocessingPipeline
â”‚
â”œâ”€â”€ ğŸ“ frontend/                     # React í”„ë¡ íŠ¸ì—”ë“œ
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/           # React ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatInterface.tsx    # ì±„íŒ… UI
â”‚   â”‚   â”‚   â””â”€â”€ Dashboard.tsx        # ëŒ€ì‹œë³´ë“œ (ì—…ë¡œë“œ, í†µê³„)
â”‚   â”‚   â”œâ”€â”€ ğŸ“ services/
â”‚   â”‚   â”‚   â””â”€â”€ api.ts               # API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ ğŸ“ types/
â”‚   â”‚   â”‚   â””â”€â”€ chat.ts              # TypeScript íƒ€ì…
â”‚   â”‚   â”œâ”€â”€ App.tsx                  # ë©”ì¸ ì•±
â”‚   â”‚   â”œâ”€â”€ main.tsx                 # ì§„ì…ì 
â”‚   â”‚   â””â”€â”€ index.css                # Tailwind CSS
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”œâ”€â”€ tailwind.config.js
â”‚   â”œâ”€â”€ Dockerfile                   # í”„ë¡ íŠ¸ì—”ë“œ Docker ë¹Œë“œ
â”‚   â””â”€â”€ nginx.conf                   # Nginx ì„¤ì •
â”‚
â”œâ”€â”€ ğŸ“ uploads/                      # ì—…ë¡œë“œëœ íŒŒì¼ (ì„ì‹œ)
â”œâ”€â”€ ğŸ“ models/                       # ëª¨ë¸ ìºì‹œ (Docker Volume)
â”‚   â””â”€â”€ ğŸ“ reranker/                 # Reranker ëª¨ë¸ ìºì‹œ
â”‚
â”œâ”€â”€ main.py                          # RAGApplication ì§„ì…ì 
â”œâ”€â”€ Dockerfile                       # ë°±ì—”ë“œ Docker ë¹Œë“œ
â”œâ”€â”€ docker-compose.yml               # ì „ì²´ ìŠ¤íƒ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â”œâ”€â”€ pyproject.toml                   # Python ì˜ì¡´ì„±
â”œâ”€â”€ .env.example                     # í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â””â”€â”€ README.md                        # ì´ ë¬¸ì„œ
```

---

## 6. ì›Œí¬í”Œë¡œìš° ìƒì„¸

### 6.1 Document Ingestion Pipeline (ë¬¸ì„œ ì—…ë¡œë“œ)

ì‚¬ìš©ìê°€ ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•˜ë©´ ë‹¤ìŒ íŒŒì´í”„ë¼ì¸ì´ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Document Ingestion Pipeline                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  STEP 1: File Upload                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚  â€¢ POST /api/v1/upload ìœ¼ë¡œ íŒŒì¼ ì „ì†¡                                        â”‚
â”‚  â€¢ ì§€ì› í˜•ì‹: PDF, DOCX, XLSX, TXT, JSON, MD                                â”‚
â”‚  â€¢ ë°±ê·¸ë¼ìš´ë“œ íƒœìŠ¤í¬ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬                                            â”‚
â”‚  â€¢ task_id ë°˜í™˜ â†’ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ í´ë§                                        â”‚
â”‚                                                                             â”‚
â”‚                              â–¼                                              â”‚
â”‚                                                                             â”‚
â”‚  STEP 2: File Parsing (UnifiedFileParser)                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚  â€¢ PDFParser: pdfplumberë¡œ í…ìŠ¤íŠ¸ + í…Œì´ë¸” ì¶”ì¶œ                              â”‚
â”‚    - max_pages=3 ì œí•œ (ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ì‹œê°„ ë‹¨ì¶•)                            â”‚
â”‚    - í…Œì´ë¸”ì€ [Table] ë§ˆì»¤ì™€ í•¨ê»˜ íŒŒì´í”„(|) êµ¬ë¶„ìë¡œ ë³€í™˜                     â”‚
â”‚  â€¢ DOCXParser: python-docxë¡œ ë‹¨ë½ + í…Œì´ë¸” ì¶”ì¶œ                              â”‚
â”‚  â€¢ XLSXParser: openpyxlë¡œ ì‹œíŠ¸ë³„ ë°ì´í„° ì¶”ì¶œ                                 â”‚
â”‚  â€¢ TXTParser: ë‹¤ì¤‘ ì¸ì½”ë”© ìë™ ê°ì§€ (UTF-8 â†’ CP949 â†’ EUC-KR â†’ Latin-1)      â”‚
â”‚  â€¢ JSONParser: ì¤‘ì²© JSONì„ ê³„ì¸µì  í…ìŠ¤íŠ¸ë¡œ ë³€í™˜                              â”‚
â”‚                                                                             â”‚
â”‚  Output: RawDocument { content, source, file_type, metadata, pages }        â”‚
â”‚                                                                             â”‚
â”‚                              â–¼                                              â”‚
â”‚                                                                             â”‚
â”‚  STEP 3: Text Normalization (TextNormalizer)                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚  â€¢ ì—°ì† ê°œí–‰ ì œê±°: \n{3,} â†’ \n\n                                            â”‚
â”‚  â€¢ ë¶ˆí•„ìš”í•œ ê³µë°± ì œê±°: [ \t]+ â†’ " "                                          â”‚
â”‚  â€¢ íŠ¹ìˆ˜ë¬¸ì í•„í„°ë§ (ì˜µì…˜)                                                    â”‚
â”‚  â€¢ ìµœì†Œ ë¼ì¸ ê¸¸ì´ í•„í„°ë§ (ì˜µì…˜)                                              â”‚
â”‚                                                                             â”‚
â”‚  Output: RawDocument (normalized=True)                                      â”‚
â”‚                                                                             â”‚
â”‚                              â–¼                                              â”‚
â”‚                                                                             â”‚
â”‚  STEP 4: Semantic Chunking (ChunkingService)                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚  â€¢ LangChain SemanticChunker ì‚¬ìš©                                           â”‚
â”‚  â€¢ OpenAI Embeddingsë¡œ ë¬¸ì¥ ê°„ ìœ ì‚¬ë„ ê³„ì‚°                                   â”‚
â”‚  â€¢ breakpoint_type="percentile", threshold=95.0                             â”‚
â”‚    â†’ ìœ ì‚¬ë„ê°€ ê¸‰ê²©íˆ ë–¨ì–´ì§€ëŠ” ì§€ì ì—ì„œ ë¶„í•                                    â”‚
â”‚  â€¢ í›„ì²˜ë¦¬:                                                                  â”‚
â”‚    - í° ì²­í¬ ë¶„í• : max_chunk_size=1500 ì´ˆê³¼ ì‹œ RecursiveCharacterSplitter   â”‚
â”‚    - ì‘ì€ ì²­í¬ ë³‘í•©: min_chunk_size=100 ë¯¸ë§Œ ì‹œ ì¸ì ‘ ì²­í¬ì™€ ë³‘í•©             â”‚
â”‚                                                                             â”‚
â”‚  Output: List[Chunk] { content, chunk_id, chunk_index, doc_id, metadata }   â”‚
â”‚                                                                             â”‚
â”‚                              â–¼                                              â”‚
â”‚                                                                             â”‚
â”‚  STEP 5: Vector Embedding & Storage (VectorStoreService)                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚  â€¢ Dense Vector: OpenAI text-embedding-3-small (1536 dims)                  â”‚
â”‚  â€¢ Sparse Vector: FastEmbed Qdrant/bm25 (BM25 í† í° ì¸ë±ìŠ¤ + TF-IDF ê°€ì¤‘ì¹˜)  â”‚
â”‚  â€¢ Qdrantì— Pointë¡œ ì €ì¥:                                                   â”‚
â”‚    {                                                                        â”‚
â”‚      id: uuid,                                                              â”‚
â”‚      vector: {                                                              â”‚
â”‚        "dense": [0.12, -0.34, ...],   // 1536 dims                          â”‚
â”‚        "bm25": SparseVector(indices=[...], values=[...])                    â”‚
â”‚      },                                                                     â”‚
â”‚      payload: { content, chunk_id, doc_id, file_name, ... }                 â”‚
â”‚    }                                                                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 RAG Query Pipeline (ì§ˆì˜ ì²˜ë¦¬)

ì‚¬ìš©ìê°€ ì§ˆë¬¸ì„ ì…ë ¥í•˜ë©´ LangGraphê°€ ë‹¤ìŒ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           RAG Query Pipeline                                 â”‚
â”‚                         (LangGraph Workflow)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  INPUT: question = "í™˜ë¶ˆ ê·œì •ì´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"                               â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚  STEP 0: Router (route_question)                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚
â”‚  â€¢ GPT-4o-minië¡œ ì§ˆë¬¸ ë¶„ë¥˜                                                   â”‚
â”‚  â€¢ Structured Output: RouteQuery { datasource: "vectorstore" | "llm" }      â”‚
â”‚                                                                             â”‚
â”‚  íŒë‹¨ ê¸°ì¤€:                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚        vectorstore              â”‚            llm                 â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ "í™˜ë¶ˆ ê·œì • ì•Œë ¤ì¤˜"              â”‚ "ì•ˆë…•í•˜ì„¸ìš”"                    â”‚        â”‚
â”‚  â”‚ "A í”„ë¡œì íŠ¸ ë‹´ë‹¹ì ëˆ„êµ¬?"       â”‚ "íŒŒì´ì¬ ë¦¬ìŠ¤íŠ¸ ì •ë ¬ë²•"          â”‚        â”‚
â”‚  â”‚ "ê³„ì•½ ì¡°ê±´ í™•ì¸"                â”‚ "ë‚ ì”¨ ì–´ë•Œ?"                    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                             â”‚
â”‚  â†’ vectorstore: query_rewrite ë…¸ë“œë¡œ ì´ë™                                   â”‚
â”‚  â†’ llm: simple_generator ë…¸ë“œë¡œ ì´ë™ (ê²€ìƒ‰ ìŠ¤í‚µ)                             â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚  STEP 1: Query Rewrite (QueryRewriteNode) [vectorstore ê²½ë¡œ]                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
â”‚  â€¢ GPT-4o-minië¡œ ê²€ìƒ‰ ì¿¼ë¦¬ ìµœì í™”                                            â”‚
â”‚  â€¢ Structured Output: RewriteResult { queries: List[str] }                  â”‚
â”‚                                                                             â”‚
â”‚  í”„ë¡¬í”„íŠ¸ ì§€ì‹œì‚¬í•­:                                                          â”‚
â”‚  1. ëª¨í˜¸ì„± ì œê±°: ëŒ€ëª…ì‚¬ â†’ ëª…ì‚¬ë¡œ ë³€í™˜                                        â”‚
â”‚  2. ë‹¤ê°ë„ í™•ì¥: 5ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ í‘œí˜„ìœ¼ë¡œ ë³€í˜•                               â”‚
â”‚  3. ì–¸ì–´ ìœ ì§€: ì…ë ¥ ì–¸ì–´ì™€ ë™ì¼                                              â”‚
â”‚                                                                             â”‚
â”‚  ì˜ˆì‹œ:                                                                      â”‚
â”‚  Input:  "í™˜ë¶ˆ ê·œì •ì´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"                                        â”‚
â”‚  Output: [                                                                  â”‚
â”‚    "í™˜ë¶ˆ ì •ì±… ë° ì¡°ê±´",                                                      â”‚
â”‚    "ë°˜í’ˆ ë° í™˜ë¶ˆ ì ˆì°¨ ì•ˆë‚´",                                                 â”‚
â”‚    "í™˜ë¶ˆ ê°€ëŠ¥ ê¸°ê°„ ë° ë°©ë²•",                                                 â”‚
â”‚    "ì·¨ì†Œ ë° í™˜ë¶ˆ ê·œì •",                                                      â”‚
â”‚    "ê³ ê° í™˜ë¶ˆ ì •ì±… ê°€ì´ë“œ"                                                   â”‚
â”‚  ]                                                                          â”‚
â”‚                                                                             â”‚
â”‚  â†’ State ì—…ë°ì´íŠ¸: optimized_queries = [...]                                â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚  STEP 2: Retriever (RetrieverNode)                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚
â”‚                                                                             â”‚
â”‚  2-1. Hybrid Search (per query)                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  for each query in optimized_queries:                        â”‚           â”‚
â”‚  â”‚    Dense Query = OpenAI.embed(query)                         â”‚           â”‚
â”‚  â”‚    Sparse Query = BM25Service.encode_query(query)            â”‚           â”‚
â”‚  â”‚                                                              â”‚           â”‚
â”‚  â”‚    Results = Qdrant.query_points(                            â”‚           â”‚
â”‚  â”‚      prefetch=[                                              â”‚           â”‚
â”‚  â”‚        Prefetch(query=Dense, using="dense", limit=30),       â”‚           â”‚
â”‚  â”‚        Prefetch(query=Sparse, using="bm25", limit=30)        â”‚           â”‚
â”‚  â”‚      ],                                                      â”‚           â”‚
â”‚  â”‚      query=Query(fusion="rrf"),  # RRF ìœµí•©                  â”‚           â”‚
â”‚  â”‚      limit=30                                                â”‚           â”‚
â”‚  â”‚    )                                                         â”‚           â”‚
â”‚  â”‚    all_results += Results                                    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                             â”‚
â”‚  2-2. Deduplication                                                         â”‚
â”‚  â€¢ ë™ì¼ content ì¤‘ë³µ ì œê±° (set ì‚¬ìš©)                                         â”‚
â”‚  â€¢ ê²°ê³¼: ì•½ 30-100ê°œ ê³ ìœ  ë¬¸ì„œ                                               â”‚
â”‚                                                                             â”‚
â”‚  2-3. Cross-Encoder Reranking                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  POST http://infinity-reranker:7997/rerank                   â”‚           â”‚
â”‚  â”‚  {                                                           â”‚           â”‚
â”‚  â”‚    "query": original_question,                               â”‚           â”‚
â”‚  â”‚    "documents": all_results,                                 â”‚           â”‚
â”‚  â”‚    "return_documents": true                                  â”‚           â”‚
â”‚  â”‚  }                                                           â”‚           â”‚
â”‚  â”‚                                                              â”‚           â”‚
â”‚  â”‚  Response:                                                   â”‚           â”‚
â”‚  â”‚  {                                                           â”‚           â”‚
â”‚  â”‚    "results": [                                              â”‚           â”‚
â”‚  â”‚      { "document": {...}, "relevance_score": 0.92 },         â”‚           â”‚
â”‚  â”‚      { "document": {...}, "relevance_score": 0.87 },         â”‚           â”‚
â”‚  â”‚      ...                                                     â”‚           â”‚
â”‚  â”‚    ]                                                         â”‚           â”‚
â”‚  â”‚  }                                                           â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                             â”‚
â”‚  2-4. Top-K Selection                                                       â”‚
â”‚  â€¢ top_k=5 (ì„¤ì • ê°€ëŠ¥)                                                       â”‚
â”‚  â€¢ ìƒìœ„ 5ê°œ ë¬¸ì„œë§Œ ì„ íƒ                                                      â”‚
â”‚                                                                             â”‚
â”‚  â†’ State ì—…ë°ì´íŠ¸: retrieved_docs = [doc1, doc2, doc3, doc4, doc5]          â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚  STEP 3: Generator (GeneratorNode)                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚
â”‚  â€¢ GPT-4oë¡œ ìµœì¢… ë‹µë³€ ìƒì„±                                                   â”‚
â”‚  â€¢ Grounded Generation: ê²€ìƒ‰ëœ ë¬¸ì„œë§Œ ì°¸ì¡°                                   â”‚
â”‚                                                                             â”‚
â”‚  System Prompt:                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ ë‹¹ì‹ ì€ ê¸°ì—… ë‚´ë¶€ ë¬¸ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì •í™•í•œ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ”       â”‚           â”‚
â”‚  â”‚ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.                                          â”‚           â”‚
â”‚  â”‚                                                              â”‚           â”‚
â”‚  â”‚ ì§€ì¹¨ ì‚¬í•­:                                                    â”‚           â”‚
â”‚  â”‚ 1. ì‚¬ì‹¤ ê¸°ë°˜: [ì°¸ê³  ë¬¸ì„œ]ì— ìˆëŠ” ë‚´ìš©ë§Œ í¬í•¨                  â”‚           â”‚
â”‚  â”‚ 2. ì¸ìš© í‘œê¸°: ì¶œì²˜ë¥¼ ëŒ€ê´„í˜¸ ë²ˆí˜¸ë¡œ í‘œì‹œ (ì˜ˆ: [1])             â”‚           â”‚
â”‚  â”‚ 3. ëª¨ë¦„ ì¸ì •: ì°¾ì„ ìˆ˜ ì—†ìœ¼ë©´ ì†”ì§íˆ ë‹µë³€                      â”‚           â”‚
â”‚  â”‚ 4. ëª…í™•ì„±: ê°„ê²°í•˜ê²Œ ìš”ì•½                                      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                             â”‚
â”‚  Human Prompt:                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ ### ì°¸ê³  ë¬¸ì„œ (Context)                                       â”‚           â”‚
â”‚  â”‚ [1] í™˜ë¶ˆì€ êµ¬ë§¤ í›„ 7ì¼ ì´ë‚´ì— ê°€ëŠ¥í•©ë‹ˆë‹¤...                   â”‚           â”‚
â”‚  â”‚ [2] ë°˜í’ˆ ì‹œ ì œí’ˆì´ ë¯¸ê°œë´‰ ìƒíƒœì—¬ì•¼ í•©ë‹ˆë‹¤...                  â”‚           â”‚
â”‚  â”‚ [3] í™˜ë¶ˆ ê¸ˆì•¡ì€ ê²°ì œ ìˆ˜ë‹¨ì— ë”°ë¼...                           â”‚           â”‚
â”‚  â”‚                                                              â”‚           â”‚
â”‚  â”‚ ### ì§ˆë¬¸ (Question)                                           â”‚           â”‚
â”‚  â”‚ í™˜ë¶ˆ ê·œì •ì´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?                                    â”‚           â”‚
â”‚  â”‚                                                              â”‚           â”‚
â”‚  â”‚ ### ë‹µë³€:                                                     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                             â”‚
â”‚  â†’ State ì—…ë°ì´íŠ¸: final_answer = "í™˜ë¶ˆì€ êµ¬ë§¤ í›„ 7ì¼ ì´ë‚´ì— ê°€ëŠ¥í•©ë‹ˆë‹¤ [1]."â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚  OUTPUT:                                                                    â”‚
â”‚  {                                                                          â”‚
â”‚    "question": "í™˜ë¶ˆ ê·œì •ì´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?",                                 â”‚
â”‚    "optimized_queries": ["í™˜ë¶ˆ ì •ì±… ë° ì¡°ê±´", ...],                          â”‚
â”‚    "retrieved_docs": ["í™˜ë¶ˆì€ êµ¬ë§¤ í›„...", ...],                             â”‚
â”‚    "final_answer": "í™˜ë¶ˆì€ êµ¬ë§¤ í›„ 7ì¼ ì´ë‚´ì— ê°€ëŠ¥í•©ë‹ˆë‹¤. [1]..."            â”‚
â”‚  }                                                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 LangGraph State Machine

```
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚         LangGraph State Machine          â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚  START  â”‚
                                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  route_question â”‚
                                    â”‚  (Conditional   â”‚
                                    â”‚   Entry Point)  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                                       â”‚
              datasource="vectorstore"                datasource="llm"
                         â”‚                                       â”‚
                         â–¼                                       â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  query_rewrite  â”‚                     â”‚simple_generator â”‚
                â”‚                 â”‚                     â”‚                 â”‚
                â”‚  Input:         â”‚                     â”‚  Input:         â”‚
                â”‚   - question    â”‚                     â”‚   - question    â”‚
                â”‚                 â”‚                     â”‚                 â”‚
                â”‚  Output:        â”‚                     â”‚  Output:        â”‚
                â”‚   - optimized_  â”‚                     â”‚   - final_      â”‚
                â”‚     queries     â”‚                     â”‚     answer      â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                                       â”‚
                         â–¼                                       â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
                â”‚    retriever    â”‚                              â”‚
                â”‚                 â”‚                              â”‚
                â”‚  Input:         â”‚                              â”‚
                â”‚   - question    â”‚                              â”‚
                â”‚   - optimized_  â”‚                              â”‚
                â”‚     queries     â”‚                              â”‚
                â”‚                 â”‚                              â”‚
                â”‚  Output:        â”‚                              â”‚
                â”‚   - retrieved_  â”‚                              â”‚
                â”‚     docs        â”‚                              â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
                         â”‚                                       â”‚
                         â–¼                                       â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
                â”‚    generator    â”‚                              â”‚
                â”‚                 â”‚                              â”‚
                â”‚  Input:         â”‚                              â”‚
                â”‚   - question    â”‚                              â”‚
                â”‚   - retrieved_  â”‚                              â”‚
                â”‚     docs        â”‚                              â”‚
                â”‚                 â”‚                              â”‚
                â”‚  Output:        â”‚                              â”‚
                â”‚   - final_      â”‚                              â”‚
                â”‚     answer      â”‚                              â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
                         â”‚                                       â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                                             â–¼
                                         â”Œâ”€â”€â”€â”€â”€â”
                                         â”‚ END â”‚
                                         â””â”€â”€â”€â”€â”€â”˜


                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚              RAGState (TypedDict)           â”‚
                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                     â”‚ question: str          # ì›ë³¸ ì§ˆë¬¸          â”‚
                     â”‚ optimized_queries: List[str]  # ì¬ì‘ì„±ëœ ì¿¼ë¦¬â”‚
                     â”‚ retrieved_docs: List[str]     # ê²€ìƒ‰ëœ ë¬¸ì„œ â”‚
                     â”‚ final_answer: str      # ìµœì¢… ë‹µë³€          â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ì»´í¬ë„ŒíŠ¸ë³„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

### 7.1 Frontend (React)

#### 7.1.1 App.tsx - ë©”ì¸ ì»¨í…Œì´ë„ˆ

```typescript
// ì£¼ìš” ìƒíƒœ ê´€ë¦¬
const [messages, setMessages] = useState<Message[]>([]);      // ì±„íŒ… ë©”ì‹œì§€
const [uploadedFiles, setUploadedFiles] = useState<UploadedFile[]>([]);  // ì—…ë¡œë“œëœ íŒŒì¼
const [tokenUsage, setTokenUsage] = useState<TokenUsage[]>([]);  // í† í° ì‚¬ìš©ëŸ‰
const [isConnected, setIsConnected] = useState(false);        // ë°±ì—”ë“œ ì—°ê²° ìƒíƒœ

// í—¬ìŠ¤ì²´í¬ (30ì´ˆë§ˆë‹¤)
useEffect(() => {
  const checkConnection = async () => {
    const healthy = await checkHealth();  // GET /health
    setIsConnected(healthy);
  };
  checkConnection();
  const interval = setInterval(checkConnection, 30000);
  return () => clearInterval(interval);
}, []);
```

#### 7.1.2 API í´ë¼ì´ì–¸íŠ¸ (api.ts)

```typescript
// ì§ˆì˜ ì²˜ë¦¬
export const sendQuery = async (question: string): Promise<QueryResponse> => {
  const response = await apiClient.post('/api/v1/query', { question });
  return { answer: response.data.answer, sources: response.data.sources?.map(s => s.content) };
};

// íŒŒì¼ ì—…ë¡œë“œ (í´ë§ í¬í•¨)
export const uploadDocument = async (file: File): Promise<UploadResponse> => {
  // 1. íŒŒì¼ ì—…ë¡œë“œ
  const uploadResponse = await apiClient.post('/api/v1/upload', formData);

  // 2. ì™„ë£Œê¹Œì§€ í´ë§ (1ì´ˆ ê°„ê²©, ìµœëŒ€ 60íšŒ)
  const statusResponse = await pollUploadStatus(uploadResponse.data.task_id);

  return { success: true, data: { chunks_created: statusResponse.chunks_created } };
};
```

### 7.2 Backend (FastAPI)

#### 7.2.1 ì˜ì¡´ì„± ì£¼ì… (dependencies.py)

```python
class RAGAppManager:
    """ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ RAGApplication ê´€ë¦¬"""
    _instance: Optional[RAGApplication] = None

    @classmethod
    def initialize(cls, settings: Settings = None) -> RAGApplication:
        load_dotenv()
        cls._instance = RAGApplication(settings)
        cls._instance.initialize(create_collection=False)
        return cls._instance

# FastAPI Dependsë¡œ ì£¼ì…
def get_rag_app() -> RAGApplication:
    return RAGAppManager.get_instance()

# Lifespanìœ¼ë¡œ ì•± ì‹œì‘/ì¢…ë£Œ ê´€ë¦¬
@asynccontextmanager
async def lifespan(app):
    RAGAppManager.initialize()
    yield
    RAGAppManager.shutdown()
```

#### 7.2.2 RAGApplication (main.py)

```python
class RAGApplication:
    """DI Container ì—­í• """

    def __init__(self, settings: Settings = None):
        self.settings = settings or Settings()

        # Services ì´ˆê¸°í™”
        self._llm_service = LLMService(self.settings)
        self._vectorstore_service = VectorStoreService(self.settings)  # Qdrant
        self._reranker_service = RerankerService(self.settings)        # Infinity
        self._preprocessing_pipeline = PreprocessingPipeline(self.settings)

        # Nodes ì´ˆê¸°í™”
        self._query_rewrite_node = QueryRewriteNode(self._llm_service)
        self._retriever_node = RetrieverNode(self._vectorstore_service, self._reranker_service)
        self._generator_node = GeneratorNode(self._llm_service)
        self._simple_generator_node = SimpleGeneratorNode(self._llm_service)

        # Workflow ì´ˆê¸°í™”
        self._workflow = RAGWorkflow(...)
```

### 7.3 Preprocessing Services

#### 7.3.1 UnifiedFileParser (parsers.py)

```python
class UnifiedFileParser:
    """íŒŒì¼ í˜•ì‹ë³„ íŒŒì„œ ë¼ìš°íŒ…"""

    def __init__(self):
        self._parsers = [
            PDFParser(),    # .pdf
            DOCXParser(),   # .docx
            XLSXParser(),   # .xlsx, .xls
            TXTParser(),    # .txt, .md, .rst
            JSONParser()    # .json
        ]

    def parse(self, file_path: str, max_pages: int = None) -> RawDocument:
        for parser in self._parsers:
            if parser.can_you_parse(file_path):
                if isinstance(parser, PDFParser) and max_pages:
                    return parser.parse(file_path, max_pages=max_pages)
                return parser.parse(file_path)
        raise ValueError(f"ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹")

class PDFParser(BaseParser):
    """PDF íŒŒì‹± with í…Œì´ë¸” ì¶”ì¶œ"""

    def parse(self, file_path: str, max_pages: int = None) -> RawDocument:
        with pdfplumber.open(file_path) as pdf:
            pages_to_process = pdf.pages[:max_pages] if max_pages else pdf.pages

            for page in pages_to_process:
                text = page.extract_text() or ""

                # í…Œì´ë¸” ì¶”ì¶œ ë° í…ìŠ¤íŠ¸ ë³€í™˜
                for table in page.extract_tables():
                    table_text = "\n".join(
                        " | ".join(str(c or "") for c in row)
                        for row in table
                    )
                    if table_text not in text:
                        pages[-1] += f"\n\n[Table]\n{table_text}"
```

#### 7.3.2 SemanticChunker (chunking.py)

```python
class ChunkingService:
    """ì˜ë¯¸ ê¸°ë°˜ ë¬¸ì„œ ë¶„í• """

    def _initialize(self):
        self._embeddings = OpenAIEmbeddings(model="text-embedding-3-small")
        self._chunker = SemanticChunker(
            embeddings=self._embeddings,
            breakpoint_threshold_type="percentile",
            breakpoint_threshold_amount=95.0  # ìƒìœ„ 5% ë¶ˆì—°ì†ì ì—ì„œ ë¶„í• 
        )

    def _post_process_chunks(self, chunks):
        # 1. í° ì²­í¬ ë¶„í•  (max_chunk_size=1500 ì´ˆê³¼)
        split = []
        for c in chunks:
            if c.char_count > self._config.max_chunk_size:
                # RecursiveCharacterTextSplitterë¡œ ì¬ë¶„í• 
                split.extend(self._split_large_chunk(c))
            else:
                split.append(c)

        # 2. ì‘ì€ ì²­í¬ ë³‘í•© (min_chunk_size=100 ë¯¸ë§Œ)
        merged = self._merge_small_chunks(split)

        return merged
```

### 7.4 VectorStore Service (Qdrant)

```python
class VectorStoreService:
    """Qdrant Hybrid Search ì„œë¹„ìŠ¤"""

    def __init__(self, settings: Settings):
        self._client = QdrantClient(host=settings.vectorstore.host, port=settings.vectorstore.port)
        self._embeddings = OpenAIEmbeddings(model=settings.embedding.model)
        self._bm25 = BM25Service()  # FastEmbed

    def add_chunks(self, chunks: List[Chunk]) -> int:
        texts = [c.content for c in chunks]

        # Dense Vector: OpenAI Embeddings
        dense_vectors = self._embeddings.embed_documents(texts)

        # Sparse Vector: BM25 (FastEmbed)
        sparse_vectors = self._bm25.encode(texts)

        # Qdrantì— ì €ì¥
        points = [
            PointStruct(
                id=str(uuid.uuid4()),
                vector={
                    "dense": dense_vec,   # [0.12, -0.34, ...]
                    "bm25": sparse_vec    # SparseVector(indices, values)
                },
                payload=chunk.to_qdrant_payload()
            )
            for chunk, dense_vec, sparse_vec in zip(chunks, dense_vectors, sparse_vectors)
        ]
        self._client.upsert(collection_name=..., points=points)

    def hybrid_search(self, query: str, limit: int = 30) -> List[str]:
        # ì¿¼ë¦¬ ë²¡í„°í™”
        dense_query = self._embeddings.embed_query(query)
        sparse_query = self._bm25.encode_query(query)

        # Hybrid Search + RRF
        results = self._client.query_points(
            collection_name=...,
            prefetch=[
                Prefetch(query=dense_query, using="dense", limit=limit),
                Prefetch(query=sparse_query, using="bm25", limit=limit)
            ],
            query=Query(fusion="rrf"),  # Reciprocal Rank Fusion
            limit=limit
        )

        return [point.payload.get("content", "") for point in results.points]
```

### 7.5 BM25 Service (FastEmbed)

```python
class BM25Service:
    """FastEmbed ê¸°ë°˜ BM25 Sparse Vector ìƒì„±"""

    def __init__(self, model_name: str = "Qdrant/bm25"):
        self._model = SparseTextEmbedding(model_name)

    def encode(self, texts: List[str]) -> List[SparseVector]:
        """í…ìŠ¤íŠ¸ â†’ BM25 Sparse Vector"""
        embeddings = list(self._model.embed(texts))
        return [
            SparseVector(
                indices=emb.indices.tolist(),  # í† í° ì¸ë±ìŠ¤
                values=emb.values.tolist()     # TF-IDF ê°€ì¤‘ì¹˜
            )
            for emb in embeddings
        ]
```

### 7.6 Reranker Service (Infinity)

```python
class RerankerService:
    """Infinity ì„œë²„ ê¸°ë°˜ Cross-Encoder Reranking"""

    def __init__(self, settings: Settings):
        self.base_url = settings.reranker.base_url  # http://infinity-reranker:7997
        self._client = httpx.Client(base_url=self.base_url, timeout=60.0)

    def rerank(self, query: str, documents: List[str], top_k: int = 5) -> List[Tuple[str, float]]:
        response = self._client.post(
            "/rerank",
            json={
                "query": query,
                "documents": documents,
                "return_documents": True
            }
        )

        results = response.json()["results"]
        # [(ë¬¸ì„œ, ì ìˆ˜), ...] í˜•íƒœë¡œ ë°˜í™˜, ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ
        return [(r["document"]["text"], r["relevance_score"]) for r in results[:top_k]]
```

### 7.7 LangGraph Workflow

```python
class RAGWorkflow:
    """LangGraph ê¸°ë°˜ RAG íŒŒì´í”„ë¼ì¸"""

    def route_question(self, state: RAGState) -> Literal["query_rewrite", "simple_generator"]:
        """ì§ˆë¬¸ ë¼ìš°íŒ…: RAG vs ì¼ë°˜ ëŒ€í™”"""
        llm = self._llm_service.get_rewrite_llm()  # GPT-4o-mini

        decision = self._llm_service.invoke_with_structured_output(
            llm=llm,
            prompt=ChatPromptTemplate.from_messages([
                ("system", ROUTER_SYSTEM_PROMPT),
                ("human", "{question}")
            ]),
            output_schema=RouteQuery,  # { datasource: "vectorstore" | "llm" }
            input_data={"question": state["question"]}
        )

        if decision.datasource == "vectorstore":
            return "query_rewrite"  # RAG ê²½ë¡œ
        else:
            return "simple_generator"  # ì¼ë°˜ ëŒ€í™” ê²½ë¡œ

    def build(self) -> "RAGWorkflow":
        workflow = StateGraph(RAGState)

        # ë…¸ë“œ ì¶”ê°€
        workflow.add_node("query_rewrite", self._query_rewrite_node)
        workflow.add_node("retriever", self._retriever_node)
        workflow.add_node("generator", self._generator_node)
        workflow.add_node("simple_generator", self._simple_generator_node)

        # ì¡°ê±´ë¶€ ì§„ì…ì 
        workflow.set_conditional_entry_point(self.route_question, {...})

        # ì—£ì§€ ì •ì˜
        workflow.add_edge("query_rewrite", "retriever")
        workflow.add_edge("retriever", "generator")
        workflow.add_edge("generator", END)
        workflow.add_edge("simple_generator", END)

        self._app = workflow.compile()
        return self
```

---

## 8. Docker Compose êµ¬ì„±

### 8.1 ì„œë¹„ìŠ¤ êµ¬ì„±ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Docker Compose Stack                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     User-Facing Services                             â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚     frontend      â”‚              â”‚      backend      â”‚          â”‚   â”‚
â”‚  â”‚  â”‚    (rag-frontend) â”‚    HTTP      â”‚   (rag-backend)   â”‚          â”‚   â”‚
â”‚  â”‚  â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                   â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  Port: 5173:80    â”‚              â”‚  Port: 8188:8188  â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  Image: nginx     â”‚              â”‚  Image: python3.13â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  Memory: ~50MB    â”‚              â”‚  Memory: ~500MB   â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â”‚                                               â”‚                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     Infrastructure Services   â”‚                      â”‚   â”‚
â”‚  â”‚                                               â”‚                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚      qdrant       â”‚    â”‚infinity-rerankerâ”‚â”‚    redis          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚   (rag-qdrant)    â”‚    â”‚(rag-infinity-   â”‚â”‚â”‚  (rag-redis)     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                   â”‚â—€â”€â”€â”€â”¤  reranker)      â”‚â—€â”¤                   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Port: 6333,6334  â”‚    â”‚                 â”‚â”‚â”‚  Port: 6379       â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Volume: qdrant_  â”‚    â”‚  Port: 8002:7997â”‚â”‚â”‚  Volume: redis_   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚    storage        â”‚    â”‚  GPU: 1x NVIDIA â”‚â”‚â”‚    data           â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  Memory: ~200MB   â”‚    â”‚  Memory: ~3GB   â”‚â”‚â”‚  Memory: ~50MB    â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚                                              â”‚                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                          External Services                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚   â”‚
â”‚  â”‚                      â”‚    OpenAI API     â”‚                          â”‚   â”‚
â”‚  â”‚                      â”‚                   â”‚                          â”‚   â”‚
â”‚  â”‚                      â”‚  - GPT-4o-mini    â”‚                          â”‚   â”‚
â”‚  â”‚                      â”‚  - GPT-4o         â”‚                          â”‚   â”‚
â”‚  â”‚                      â”‚  - text-embedding â”‚                          â”‚   â”‚
â”‚  â”‚                      â”‚    -3-small       â”‚                          â”‚   â”‚
â”‚  â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                          Named Volumes                               â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  qdrant_storage:  /qdrant/storage  (Vector DB ë°ì´í„°)               â”‚   â”‚
â”‚  â”‚  redis_data:      /data            (Redis ë°ì´í„°)                   â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 ì„œë¹„ìŠ¤ë³„ ìƒì„¸

| ì„œë¹„ìŠ¤ | ì´ë¯¸ì§€ | í¬íŠ¸ | ì—­í•  | ë¦¬ì†ŒìŠ¤ |
|--------|--------|------|------|--------|
| **frontend** | nginx:alpine | 5173:80 | React SPA ì„œë¹™, API Proxy | CPU, ~50MB RAM |
| **backend** | python:3.13-slim | 8188:8188 | FastAPI RAG API | CPU, ~500MB RAM |
| **qdrant** | qdrant/qdrant:latest | 6333, 6334 | Vector Database | CPU, ~200MB+ RAM |
| **infinity-reranker** | michaelf34/infinity:latest | 8002:7997 | Cross-Encoder Model Serving | **GPU í•„ìˆ˜**, ~3GB VRAM |
| **redis** | redis:7-alpine | 6379 | ìºì‹± (Future Use) | CPU, ~50MB RAM |

### 8.3 ì˜ì¡´ì„± ê´€ê³„

```yaml
# docker-compose.yml ì˜ì¡´ì„±

frontend:
  depends_on:
    - backend          # ë°±ì—”ë“œ ì‹œì‘ í›„ í”„ë¡ íŠ¸ì—”ë“œ

backend:
  depends_on:
    qdrant:
      condition: service_healthy    # Qdrant í—¬ìŠ¤ì²´í¬ í†µê³¼ í›„
    infinity-reranker:
      condition: service_healthy    # Infinity í—¬ìŠ¤ì²´í¬ í†µê³¼ í›„
    redis:
      condition: service_healthy    # Redis í—¬ìŠ¤ì²´í¬ í†µê³¼ í›„
```

### 8.4 í—¬ìŠ¤ì²´í¬ ì„¤ì •

```yaml
# ê° ì„œë¹„ìŠ¤ë³„ í—¬ìŠ¤ì²´í¬

qdrant:
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:6333/healthz"]
    interval: 10s
    timeout: 5s
    retries: 5
    start_period: 10s

infinity-reranker:
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:7997/health"]
    interval: 30s
    timeout: 10s
    retries: 5
    start_period: 120s  # ëª¨ë¸ ë¡œë”© ì‹œê°„

redis:
  healthcheck:
    test: ["CMD", "redis-cli", "ping"]
    interval: 10s
    timeout: 5s
    retries: 5

backend:
  healthcheck:
    test: ["CMD", "curl", "-f", "http://localhost:8188/api/v1/health"]
    interval: 30s
    timeout: 10s
    retries: 3
    start_period: 60s
```

---

## 9. ì‹¤í–‰ ë°©ë²•

### 9.1 ì‚¬ì „ ìš”êµ¬ì‚¬í•­

| ìš”êµ¬ì‚¬í•­ | ìµœì†Œ ë²„ì „ | ë¹„ê³  |
|----------|-----------|------|
| Docker | 24.0+ | Docker Desktop ë˜ëŠ” Docker Engine |
| Docker Compose | 2.20+ | docker compose (v2) |
| NVIDIA Driver | 535+ | GPU ì‚¬ìš© ì‹œ |
| nvidia-docker2 | - | GPU ì»¨í…Œì´ë„ˆ ì§€ì› |
| OpenAI API Key | - | GPT-4o ì•¡ì„¸ìŠ¤ ê¶Œí•œ |

### 9.2 GPU ì„¤ì • (í•„ìˆ˜)

```bash
# NVIDIA Container Toolkit ì„¤ì¹˜ (Ubuntu)
distribution=$(. /etc/os-release;echo $ID$VERSION_ID)
curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -
curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | \
  sudo tee /etc/apt/sources.list.d/nvidia-docker.list

sudo apt-get update
sudo apt-get install -y nvidia-container-toolkit
sudo systemctl restart docker

# í™•ì¸
docker run --rm --gpus all nvidia/cuda:12.0-base nvidia-smi
```

### 9.3 í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
# .env íŒŒì¼ ìƒì„±
cp .env.example .env

# OpenAI API Key ì„¤ì •
echo "OPENAI_API_KEY=sk-..." >> .env
```

**.env íŒŒì¼ ì˜ˆì‹œ:**
```env
# Required
OPENAI_API_KEY=sk-your-api-key-here

# Optional (defaults shown)
QDRANT_HOST=qdrant
QDRANT_PORT=6333
RERANKER_BASE_URL=http://infinity-reranker:7997
REDIS_HOST=redis
REDIS_PORT=6379
```

### 9.4 Docker Compose ì‹¤í–‰

```bash
# ì „ì²´ ìŠ¤íƒ ì‹œì‘ (ë°±ê·¸ë¼ìš´ë“œ)
docker compose up -d

# ë¡œê·¸ í™•ì¸ (ì‹¤ì‹œê°„)
docker compose logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker compose logs -f backend
docker compose logs -f infinity-reranker

# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
docker compose ps

# í—¬ìŠ¤ì²´í¬ ìƒíƒœ í™•ì¸
docker compose ps --format "table {{.Name}}\t{{.Status}}"
```

### 9.5 ì„œë¹„ìŠ¤ ì ‘ì†

| ì„œë¹„ìŠ¤ | URL | ì„¤ëª… |
|--------|-----|------|
| **Frontend** | http://localhost:5173 | React ëŒ€ì‹œë³´ë“œ |
| **API Docs** | http://localhost:8188/docs | Swagger UI |
| **API ReDoc** | http://localhost:8188/redoc | ReDoc |
| **Health Check** | http://localhost:8188/health | ìƒíƒœ í™•ì¸ |
| **Qdrant Dashboard** | http://localhost:6333/dashboard | Vector DB ê´€ë¦¬ |

### 9.6 ì´ˆê¸° ì„¤ì •

```bash
# 1. ì»¬ë ‰ì…˜ ìƒì„± (ìµœì´ˆ 1íšŒ)
curl -X POST http://localhost:8188/api/v1/collection/create

# ë˜ëŠ” Pythonìœ¼ë¡œ
python -c "
from src.main import create_app
app = create_app().initialize(create_collection=True)
print('Collection created!')
app.close()
"
```

### 9.7 í…ŒìŠ¤íŠ¸

```bash
# í—¬ìŠ¤ì²´í¬
curl http://localhost:8188/health
# {"status": "ok"}

# ìƒì„¸ í—¬ìŠ¤ì²´í¬
curl http://localhost:8188/api/v1/health
# {"status": "healthy", "qdrant_connected": true, "document_count": 0, "version": "2.0.0"}

# íŒŒì¼ ì—…ë¡œë“œ
curl -X POST http://localhost:8188/api/v1/upload \
  -F "file=@/path/to/document.pdf"

# ì§ˆì˜
curl -X POST http://localhost:8188/api/v1/query \
  -H "Content-Type: application/json" \
  -d '{"question": "í™˜ë¶ˆ ê·œì •ì´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"}'
```

### 9.8 ì¢…ë£Œ ë° ì •ë¦¬

```bash
# ì„œë¹„ìŠ¤ ì¤‘ì§€
docker compose down

# ì„œë¹„ìŠ¤ ì¤‘ì§€ + ë³¼ë¥¨ ì‚­ì œ (ë°ì´í„° ì´ˆê¸°í™”)
docker compose down -v

# ì´ë¯¸ì§€ ì¬ë¹Œë“œ
docker compose build --no-cache

# ì „ì²´ ì¬ì‹œì‘
docker compose down && docker compose up -d --build
```

---

## 10. API Reference

### 10.1 Query API

#### POST /api/v1/query

RAG ì§ˆì˜ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.

**Request:**
```json
{
  "question": "í™˜ë¶ˆ ê·œì •ì´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?"
}
```

**Response:**
```json
{
  "answer": "í™˜ë¶ˆì€ êµ¬ë§¤ í›„ 7ì¼ ì´ë‚´ì— ê°€ëŠ¥í•©ë‹ˆë‹¤. [1] ë°˜í’ˆ ì‹œ ì œí’ˆì´ ë¯¸ê°œë´‰ ìƒíƒœì—¬ì•¼ í•©ë‹ˆë‹¤. [2]",
  "sources": [
    {
      "content": "í™˜ë¶ˆì€ êµ¬ë§¤ í›„ 7ì¼ ì´ë‚´ì— ê°€ëŠ¥í•©ë‹ˆë‹¤...",
      "source": null,
      "score": null
    },
    {
      "content": "ë°˜í’ˆ ì‹œ ì œí’ˆì´ ë¯¸ê°œë´‰ ìƒíƒœì—¬ì•¼ í•©ë‹ˆë‹¤...",
      "source": null,
      "score": null
    }
  ],
  "processing_time_ms": 2345.67
}
```

### 10.2 Upload API

#### POST /api/v1/upload

íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.

**Request:**
```
Content-Type: multipart/form-data
file: <binary>
```

**Response:**
```json
{
  "task_id": "550e8400-e29b-41d4-a716-446655440000",
  "file_name": "document.pdf",
  "status": "pending",
  "message": "íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ. ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬ ì¤‘."
}
```

#### GET /api/v1/upload/{task_id}

ì—…ë¡œë“œ ì²˜ë¦¬ ìƒíƒœë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

**Response:**
```json
{
  "task_id": "550e8400-e29b-41d4-a716-446655440000",
  "status": "completed",
  "file_name": "document.pdf",
  "chunks_created": 15,
  "error": null,
  "completed_at": "2024-01-15T10:30:00.000Z"
}
```

### 10.3 Admin API

#### GET /health

ê°„ë‹¨í•œ í—¬ìŠ¤ì²´í¬ì…ë‹ˆë‹¤.

**Response:**
```json
{
  "status": "ok"
}
```

#### GET /api/v1/health

ìƒì„¸ í—¬ìŠ¤ì²´í¬ì…ë‹ˆë‹¤.

**Response:**
```json
{
  "status": "healthy",
  "qdrant_connected": true,
  "document_count": 150,
  "version": "2.0.0"
}
```

#### GET /api/v1/collections

ì»¬ë ‰ì…˜ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

**Response:**
```json
{
  "collections": [
    {
      "name": "rag_chunks",
      "document_count": 150,
      "is_ready": true
    }
  ]
}
```

#### DELETE /api/v1/collection/{name}

ì»¬ë ‰ì…˜ì„ ì‚­ì œí•˜ê³  ì¬ìƒì„±í•©ë‹ˆë‹¤.

**Response:**
```json
{
  "success": true,
  "message": "ì»¬ë ‰ì…˜ì´ ì¬ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "deleted_collection": "rag_chunks"
}
```

---

## 11. í™˜ê²½ ë³€ìˆ˜

| ë³€ìˆ˜ | ì„¤ëª… | ê¸°ë³¸ê°’ | í•„ìˆ˜ |
|------|------|--------|------|
| `OPENAI_API_KEY` | OpenAI API í‚¤ | - | **í•„ìˆ˜** |
| `QDRANT_HOST` | Qdrant í˜¸ìŠ¤íŠ¸ | `localhost` | |
| `QDRANT_PORT` | Qdrant HTTP í¬íŠ¸ | `6333` | |
| `QDRANT_GRPC_PORT` | Qdrant gRPC í¬íŠ¸ | `6334` | |
| `RERANKER_BASE_URL` | Infinity Reranker URL | `http://localhost:8002` | |
| `REDIS_HOST` | Redis í˜¸ìŠ¤íŠ¸ | `localhost` | |
| `REDIS_PORT` | Redis í¬íŠ¸ | `6379` | |

---

## 12. ê°œë°œ ê°€ì´ë“œ

### 12.1 ë¡œì»¬ ê°œë°œ í™˜ê²½

```bash
# 1. Python ê°€ìƒí™˜ê²½ (ê¶Œì¥: uv ì‚¬ìš©)
pip install uv
uv venv
source .venv/bin/activate

# 2. ì˜ì¡´ì„± ì„¤ì¹˜
uv pip install -e ".[dev]"

# 3. ì¸í”„ë¼ë§Œ Dockerë¡œ ì‹¤í–‰
docker compose up -d qdrant redis infinity-reranker

# 4. ë°±ì—”ë“œ ê°œë°œ ì„œë²„
uvicorn src.api.main:app --reload --port 8188

# 5. í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì„œë²„
cd frontend
npm install
npm run dev
```

### 12.2 í…ŒìŠ¤íŠ¸

```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
pytest tests/ -v

# ì»¤ë²„ë¦¬ì§€
pytest tests/ --cov=src --cov-report=html

# íŠ¹ì • í…ŒìŠ¤íŠ¸
pytest tests/test_vectorstore.py -v
```

### 12.3 ì½”ë“œ ìŠ¤íƒ€ì¼

```bash
# Linting
ruff check src/

# Formatting
ruff format src/

# Type checking
mypy src/
```

### 12.4 ìƒˆ íŒŒì„œ ì¶”ê°€í•˜ê¸°

```python
# src/services/preprocessing/parsers.py

class NewFormatParser(BaseParser):
    @property
    def supported_extensions(self) -> List[str]:
        return ["newformat"]  # ì§€ì›í•  í™•ì¥ì

    def parse(self, file_path: str) -> RawDocument:
        file_info = self._get_file_info(file_path)

        # íŒŒì‹± ë¡œì§ êµ¬í˜„
        content = ...

        return RawDocument(
            content=content,
            source=str(Path(file_path).absolute()),
            file_type="newformat",
            file_name=file_info["file_name"],
            metadata=file_info
        )

# UnifiedFileParserì— ì¶”ê°€
class UnifiedFileParser:
    def __init__(self):
        self._parsers = [
            ...,
            NewFormatParser()  # ì¶”ê°€
        ]
```

### 12.5 ìƒˆ ë…¸ë“œ ì¶”ê°€í•˜ê¸°

```python
# src/nodes/new_node.py

from .base import BaseNode
from ..schemas import RAGState

class NewNode(BaseNode):
    @property
    def name(self) -> str:
        return "new_node"

    def __call__(self, state: RAGState) -> Dict[str, Any]:
        # ë…¸ë“œ ë¡œì§ êµ¬í˜„
        return {"some_output": "value"}

# workflow.pyì—ì„œ ê·¸ë˜í”„ì— ì¶”ê°€
workflow.add_node("new_node", self._new_node)
workflow.add_edge("previous_node", "new_node")
```

---

## License

MIT License

---

## Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## Contact

í”„ë¡œì íŠ¸ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì´ìŠˆë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”.
